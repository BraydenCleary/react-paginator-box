var React=require("react"),ReactPaginatorBox=null;!function(t,e){"use strict";var s=t.createClass({hasClass:function(t,e){if(t.classList)return t.classList.contains(e);var s=new RegExp("(^|\\s)"+e+"(\\s|$)","g");return s.test(t.className)?!0:!1},changePageHandler:function(t){var e=t.target.parentNode,s=t.target.getAttribute("data-angular");this.props.reload?this.props.changePage(parseInt(t.target.getAttribute("data-page"))):(t.preventDefault(),t.stopPropagation(),"true"===s?this.hasClass(e,"disabled")||this.props.changePage(parseInt(t.target.getAttribute("data-page"))):this.hasClass(e,"active")||this.props.changePage(parseInt(t.target.getAttribute("data-page"))))},render:function(){var t=this.props.param;return React.createElement("li",{className:t["class"]},React.createElement("a",{href:t.href,"data-angular":t.angular,"data-page":t.page,onClick:this.changePageHandler},t.text))}}),r=t.createClass({render:function(){var t=this.props.param;return React.createElement("li",null,React.createElement("span",null,t.text))}}),a=t.createClass({render:function(){var t=this.props.list.map(function(t){return t.link?React.createElement(s,{param:t,reload:this.props.reload,changePage:this.props.changePage}):React.createElement(r,{param:t})}.bind(this));return React.createElement("ul",null,t)}});ReactPaginatorBox=t.createClass({propTypes:{items:t.PropTypes.number,limit:t.PropTypes.number,display:t.PropTypes.number,startPage:t.PropTypes.number,nextText:t.PropTypes.string,prevText:t.PropTypes.string},getInitialState:function(){return{list:[]}},getInterval:function(){return{start:e.ceil(this.props.currentPage>this.props.halfDisplay?e.max(e.min(this.props.currentPage-this.props.halfDisplay,this.props.pageCount-this.props.display),0):0),end:e.ceil(this.props.currentPage>this.props.halfDisplay?e.min(this.props.currentPage+this.props.halfDisplay,this.props.pageCount):e.min(this.props.display,this.props.pageCount))}},ext:function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);return t},componentWillMount:function(){var t={items:100,reload:!0,hrefPrefix:"?page=",hrefParams:"",startPage:1,end:2,currentPage:0,angularLink:!0,edgeLinks:!0,nextText:"Next",prevText:"Prev",firstText:"First",lastText:"Last"};Object.defineProperties(t,{display:{get:function(){return this._display},set:function(t){this._display=t,this.halfDisplay=t/2}},limit:{get:function(){return this._limit},set:function(t){this._limit=t,this.pageCount=e.ceil(this.items/t)}}}),this.props=this.ext(t,this.props.options),this.props.limit?"":this.props.limit=10,!this.props.display||this.props.display<3?this.props.display=5:"",this.props.pageCount>0&&(this.props.currentPage=this.props.startPage-1,this.setState({list:this.buildList()}))},buildList:function(){var t=[],e=this.getInterval();return this.firstLinks(t,e).intervalLink(t,e).lasterLinks(t,e)},addItem:function(t){return t=0>t?0:t<this.props.pageCount?t:this.props.pageCount-1,{"class":t===this.props.currentPage?"active":"",link:!0,page:t,text:t+1,href:this.props.hrefPrefix+(t+1)+this.props.hrefParams}},addAngItem:function(t,e,s,r){var a;switch(s=s||0,t){case"prev":a=this.props.prevText;break;case"first":a=this.props.firstText;break;case"last":a=this.props.lastText;break;case"next":a=this.props.nextText}return{"class":e?"disabled":"",link:!0,page:s,href:this.props.hrefPrefix+(r?s+1:s)+this.props.hrefParams,angular:!0,text:a}},firstLinks:function(t,s){if(this.props.angularLink&&this.generatedPrevLink(t),s.start>0){for(var r=e.min(this.props.end,s.start),a=0;r>a;a++)t.push(this.addItem(a));s.start-this.props.end===1&&t.push(this.addItem(this.props.end)),s.start>this.props.end&&s.start-this.props.end!==1&&t.push({"class":"not-use",link:!1,text:"..."})}return{intervalLink:this.intervalLink}},generatedPrevLink:function(t){0===this.props.currentPage?(this.props.edgeLinks&&t.push(this.addAngItem("first",!0)),t.push(this.addAngItem("prev",!0))):(this.props.edgeLinks&&t.push(this.addAngItem("first",!1,0,!0)),t.push(this.addAngItem("prev",!1,this.props.currentPage-1<0?0:this.props.currentPage-1,!0)))},generatedNextLink:function(t){this.props.currentPage+1===this.props.pageCount?(t.push(this.addAngItem("next",!0)),this.props.edgeLinks&&t.push(this.addAngItem("last",!0))):(t.push(this.addAngItem("next",!1,this.props.currentPage+1<this.props.pageCount?this.props.currentPage+1:this.props.pageCount-1,!0)),this.props.edgeLinks&&t.push(this.addAngItem("last",!1,this.props.pageCount-1,!0)))},intervalLink:function(t,e){for(var s=e.start;s<e.end;s++)t.push(this.addItem(s));return{lasterLinks:this.lasterLinks}},lasterLinks:function(t,s){if(s.end<this.props.pageCount){var r=e.max(this.props.pageCount-this.props.end,s.end);this.props.pageCount-this.props.end>s.end&&this.props.pageCount-this.props.end-s.end!==1&&t.push({"class":"not-use",link:!1,text:"..."}),this.props.pageCount-this.props.end-s.end===1&&t.push(this.addItem(s.end));for(var a=r;a<this.props.pageCount;a++)t.push(this.addItem(a))}return this.props.angularLink&&this.generatedNextLink(t),t},changePageHandler:function(t){setTimeout(function(){t>=0&&t<=this.props.pageCount-1&&(this.props.currentPage=t,this.setState({list:this.buildList()}))}.bind(this),0)},render:function(){return React.createElement("div",{className:"pagination-box"},React.createElement(a,{reload:this.props.reload,list:this.state.list,changePage:this.changePageHandler}))}})}(React,Math),module.exports=ReactPaginatorBox;